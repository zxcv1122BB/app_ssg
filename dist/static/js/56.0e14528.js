webpackJsonp([56],{BDxa:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,n=i("mvHQ"),s=(a=n)&&a.__esModule?a:{default:a};e.default={name:"wChat",data:function(){return{chatList:[],onlineUser:[],onlineAdmin:[],userType:0,onMess:this.base.privateMess,id:0,page:"1",isLoadPage:0}},created:function(){var t=this;this.$nextTick(function(){t.getOnline()})},mounted:function(){this.clickSliup(),this.loadMorePage()},methods:{clickLoad:function(){0==this.isLoadPage&&(this.page=parseInt(this.page)+1,$(".has-more").html(""),$(".has-more").append('<img src="static/images/wait.gif" width="15" height="15" /><span>正在努力加载中...</span>'),this.getOnline())},loadMorePage:function(){var t=0,e=this,i={loadmore:function(a){1!=e.isLoadPage&&(0==t&&$(a).scrollTop()+$(a).height()-$(document).height()-$("#header").height()>-10&&(t=1,setTimeout(function(){e.page=parseInt(e.page)+1,i.wipeUpdate(),t=0},200)))},wipeUpdate:function(){$(".has-more").html(""),$(".has-more").append('<img src="static/images/wait.gif" width="15" height="15" /><span>正在努力加载中...</span>'),e.getOnline()},init:function(){$(window).scroll(function(){i.loadmore($(this))})}};i.init()},getOnline:function(){var t=this;if(1!=t.isLoadPage){t.isLoadPage=1,t.onMess=t.base.privateMess;var e={type:"post",data:{pageNum:""+t.page},dataType:"json",url:"/commonAPI/getUserOnline",success:function(e){if(200==e.code){var i=$.parseJSON(e.body);for(var a in t.userType=localStorage.userType,i)1==i[a].userType?t.onlineUser.push({name:a}):2==i[a].userType&&t.onlineAdmin.push({name:a})}else 1!=t.page&&(t.page-=1);$(".has-more").html("点击加载"),t.isLoadPage=0},error:function(t){}};this.base.callCommonApi(e)}},clickSliup:function(){$("#wChat").click(function(){$("#mores").slideUp()})},getMore:function(){$("#mores").slideToggle(),$(".background_gray").slideUp()},togoChat:function(t,e){1!=this.id?(0!=t&&(this.chatList[e].id=1),this.$router.push({name:"chat",params:{chatName:t}})):this.id=0},togoPrivate:function(){if(2!=this.userType){if(1==this.userType){if(0==this.onlineAdmin.length)return mui.toast("当前没有在线的管理员"),$("#mores").hide(),void $(this).slideUp()}else if(3==this.userType&&0==this.onlineUser.length)return mui.toast("当前没有在线的会员"),$("#mores").hide(),void $(this).slideUp();$(".background_gray").slideToggle()}else mui.toast("试玩用户无法私聊")},delectChat:function(t){this.chatList.splice(t,1),mui.toast("删除成功"),this.id=1},privateChat:function(t){if(t!=localStorage.userName){var e=[];this.chatList.map(function(t){e.push(t.chatName)}),-1==e.indexOf(t)?this.chatList.push({chatName:t,id:1}):mui.toast("该私聊已存在"),$(".background_gray").slideUp(),$("#mores").slideUp()}},routerBack:function(){localStorage.turnPathName&&"login"!=localStorage.turnPathName?this.$router.go(-1):this.$router.push({name:"index"})}},watch:{onMess:function(){var t=[];if(this.chatList.map(function(e){t.push(e.chatName)}),0!=this.base.privateMess.length)for(var e=0;e<this.base.privateMess.length;e++)if(this.base.privateMess[e].uName!=localStorage.userName)if(-1==t.indexOf(this.base.privateMess[e].uName))this.chatList.push({chatName:this.base.privateMess[e].uName,id:0});else for(var i in this.chatList)this.chatList[i].chatName==this.base.privateMess[e].uName&&(this.chatList[i].id=0),this.chatList[i].chatName==localStorage.chatName&&(this.chatList[i].id=1,localStorage.chatName="")},$route:function(t,e){var i=this;"wChat"==t.name?(this.page="1",this.onlineUser=[],this.$nextTick(function(){i.getOnline(),$("#mores").slideUp(),$(".background_gray").slideUp(),i.chatList=[],i.onlineAdmin=[],i.onlineUser=[];var t=JSON.parse(localStorage.chatList);i.chatList=t})):"wChat"==e.name&&($("#mores").slideUp(),$(".background_gray").slideUp(),localStorage.chatList=(0,s.default)(this.chatList))}}}},Riih:function(t,e,i){"use strict";var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{attrs:{id:"container"}},[i("div",{attrs:{id:"main"}},[i("header",{attrs:{id:"header"}},[i("span",{staticClass:"goBack",attrs:{href:"javascript:void(0)"},on:{click:t.routerBack}}),t._v(" "),i("h1",[t._v(t._s(t.$t("聊天列表")))]),t._v(" "),i("span",{staticStyle:{position:"absolute",top:".6rem",right:"1.5rem"},on:{click:function(e){t.getMore()}}},[i("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAb0lEQVRIS2NkoBFgpJG5DEQb/P//fwOQIxgZGS8Q4xhSDD4ANdhh1ODRoICkgf///5MXFNB02o8nKYHTMQMDA750XAhL5/B0DDV4AoUGF2AYTCjRkx0UowaPFkLwNEBKUNCmoCeUHNHliXYxqQYDAPg4TBfyIdx8AAAAAElFTkSuQmCC"}})]),t._v(" "),i("ul",{staticStyle:{width:"41%"},attrs:{id:"mores"}},[i("li",{on:{click:function(e){t.togoPrivate()}}},[t._v(t._s(t.$t("私聊"))),3==t.userType?i("span",[t._v(t._s(t.$t("会员")))]):i("span",[t._v(t._s(t.$t("管理员")))])])])]),t._v(" "),i("article",{attrs:{id:"wChat"}},[i("ul",{staticClass:"mui-table-view",attrs:{id:"OA_task_1"}},[i("li",{staticStyle:{padding:".8rem 1rem"},on:{click:function(e){t.togoChat(0,t.index)}}},[t._m(0),t._v(" "),i("span",{staticStyle:{float:"left","padding-top":".5rem","padding-left":"5rem"}},[t._v(t._s(t.$t("公共聊天室")))])]),t._v(" "),i("li",{staticStyle:{clear:"both","border-bottom":"1px solid #E3E3E3"}}),t._v(" "),t._l(t.chatList,function(e,a){return i("li",{staticClass:"mui-table-view-cell",on:{click:function(i){t.togoChat(e.chatName,a)}}},[i("div",{staticClass:"mui-slider-right mui-disabled",on:{click:function(e){t.delectChat(a)}}},[i("a",{staticClass:"mui-btn mui-btn-red"},[t._v(t._s(t.$t("删除")))])]),t._v(" "),i("div",{staticClass:"mui-slider-handle"},[t._m(1,!0),t._v(" "),i("span",{staticStyle:{float:"left","padding-top":".5rem","padding-left":"5rem"}},[t._v(t._s(e.chatName))]),t._v(" "),0==e.id?i("span",{staticStyle:{float:"right","padding-top":".6rem"}},[i("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABVUlEQVQ4T7WUsVXDMBRF33cVaDAduBIVKA0ZgQ0wE5BsYCYgmSBsEHsCkg0YwRU+VIhGpDRNoLI4EnaIQZZ9OMalJV3995/eJ/T8kYv3FLCwAM6VwkjvI0JKQHomxarpnBWYHbGx8jAnwLcdVEBOBSK+FsnP9Rrw2Wf++x4WRAg7diIebHBzkou82l8DPh6zJREuLbBZ+e/WshZzKSa/gFomPCwaKnMBgQITvhax6XMFyAKmyz74C1D3dCjF4RZYunnv6Ju7QgAecHUqxdJUmAVsCsDWn+qOViCAGZdiaoAOMzoDlcJq+CrC3oAAEi7F+H8kt5qi8GC0Ey6ajKuZUhrjejZtwXnjUpiYfr/Dvh+2y22lcFdOm8hSqjHDmmU9HD72zeHrNo3lejLYIGocDtsYfsnXYGsUlcILKUyr/O5e3mXAjnYHrAekOmJNCpzAjrJr2z4B0R+FFYVOEKwAAAAASUVORK5CYII="}})]):t._e()])])})],2),t._v(" "),i("div",{staticClass:"background_gray"},[3==t.userType?i("div",[i("p",[t._v(t._s(t.$t("请选择你要私聊的会员")))]),t._v(" "),t._l(t.onlineUser,function(e){return i("div",{on:{click:function(i){t.privateChat(e.name)}}},[i("ul",[t._m(2,!0),t._v(" "),i("li",[t._v(t._s(e.name))])])])}),t._v(" "),i("div",{staticClass:"has-more",staticStyle:{"text-align":"center","line-height":"40px",color:"#666"},on:{click:t.clickLoad}},[t._v(t._s(t.$t("点击加载")))])],2):1==t.userType?i("div",[i("p",[t._v(t._s(t.$t("请选择你要私聊的管理员")))]),t._v(" "),t._l(t.onlineAdmin,function(e){return i("div",{on:{click:function(i){t.privateChat(e.name)}}},[i("ul",[t._m(3,!0),t._v(" "),i("li",[t._v(t._s(e.name))])])])}),t._v(" "),i("div",{staticClass:"has-more",staticStyle:{"text-align":"center","line-height":"40px",color:"#666"},on:{click:t.clickLoad}},[t._v(t._s(t.$t("点击加载")))])],2):t._e()])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticStyle:{float:"left"}},[e("img",{staticStyle:{width:"2.5rem"},attrs:{src:i("i+kl")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticStyle:{float:"left"}},[e("img",{staticStyle:{width:"2.5rem"},attrs:{src:i("i+kl")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("img",{attrs:{src:i("i+kl")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("img",{attrs:{src:i("i+kl")}})])}]};e.a=a},ZLOW:function(t,e,i){var a=i("omt5");"string"==typeof a&&(a=[[t.i,a,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i("MTIv")(a,n);a.locals&&(t.exports=a.locals)},omt5:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\narticle[data-v-5c1b5198]{\n\tposition: relative;\n\theight: 610px;\n}\n#mores[data-v-5c1b5198] {\n\tz-index: 999;\n\tposition: absolute;\n\ttop: 2.6rem;\n\tright: 0;\n\tbackground: white;\n\tdisplay: none;\n}\n#wChat .background_gray[data-v-5c1b5198]{\n\tposition: absolute;\n\tdisplay: none;\n\ttop: 0rem;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: auto;\n\tbackground: white;\n\tz-index: 99;\n\tpadding-top: 2rem !important;\n}\n#wChat .background_gray p[data-v-5c1b5198]{\n\tpadding-left: 1rem;\n\tcolor: gray;\n}\n#wChat ul li[data-v-5c1b5198]{\n\t/*line-height: 3rem;*/\n\tpadding-left: 1rem;\n}\n#wChat .mui-table-view-cell[data-v-5c1b5198]{\n\tpadding: .5rem 1rem;\n}\n.background_gray ul[data-v-5c1b5198] {\n\tmargin: .5rem;\n\tborder-bottom: 1px #D3D3D3 solid;\n}\n.background_gray ul li[data-v-5c1b5198] {\n\ttext-align: center;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n\tmargin-right: 2rem;\n}\n.background_gray ul li img[data-v-5c1b5198]{\n\t width: 2.5rem;\n}\n",""])},rmEn:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("BDxa"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);var r=i("Riih");var o=function(t){i("ZLOW")},c=i("VU/8")(n.a,r.a,!1,o,"data-v-5c1b5198",null);e.default=c.exports}});